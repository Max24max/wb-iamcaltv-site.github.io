var pl = {"salt":"csvTGVWujiLTxpfpqYuUX92ZdU/Ly3t/my4LGuwme3k=","iv":"GCDe3rv+Gp/XNqbpzumhRA==","data":"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"};

var submitPass = document.getElementById('submitPass');
var passEl = document.getElementById('pass');
var invalidPassEl = document.getElementById('invalidPass');
var successEl = document.getElementById('success');
var contentFrame = document.getElementById('contentFrame');

if (pl === "") {
  submitPass.disabled = true;
  passEl.disabled = true;
  alert("This page is meant to be used with the encryption tool. It doesn't work standalone.");
}

function doSubmit(evt) {
  try {
    var decrypted = decryptFile(CryptoJS.enc.Base64.parse(pl.data), passEl.value, CryptoJS.enc.Base64.parse(pl.salt), CryptoJS.enc.Base64.parse(pl.iv));
    if (decrypted === "") throw "No data returned";

    // Set default iframe link targets to _top so all links break out of the iframe
    decrypted = decrypted.replace("<head>", "<head><base href=\".\" target=\"_top\">");

    srcDoc.set(contentFrame, decrypted);

    successEl.style.display = "inline";
    passEl.disabled = true;
    submitPass.disabled = true;
    setTimeout(function() {
      dialogWrap.style.display = "none";
    }, 1000);
  } catch (e) {
    invalidPassEl.style.display = "inline";
    passEl.value = "";
  }
}

submitPass.onclick = doSubmit;
passEl.onkeypress = function(e) {
  if (!e) e = window.event;
  var keyCode = e.keyCode || e.which;
  invalidPassEl.style.display = "none";
  if (keyCode == '13'){
    // Enter pressed
    doSubmit();
    return false;
  }
};

function decryptFile(contents, password, salt, iv) {
  var _cp = CryptoJS.lib.CipherParams.create({
    ciphertext: contents
  });
  var key = CryptoJS.PBKDF2(password, salt, { keySize: 256/32, iterations: 100 });
  var decrypted = CryptoJS.AES.decrypt(_cp, key, {iv: iv});

  return decrypted.toString(CryptoJS.enc.Utf8);
}
