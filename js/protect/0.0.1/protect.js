var pl = {"salt":"JOOuyR0LARAYGkJDuVeXeJaM/G/YMHvv8wure+SdcZ8=","iv":"1BiFh7bMhwyJue/WjCYtZg==","data":"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"};

var submitPass = document.getElementById('submitPass');
var passEl = document.getElementById('pass');
var invalidPassEl = document.getElementById('invalidPass');
var successEl = document.getElementById('success');
var contentFrame = document.getElementById('contentFrame');

if (pl === "") {
  submitPass.disabled = true;
  passEl.disabled = true;
  alert("This page is meant to be used with the encryption tool. It doesn't work standalone.");
}

function doSubmit(evt) {
  try {
    var decrypted = decryptFile(CryptoJS.enc.Base64.parse(pl.data), passEl.value, CryptoJS.enc.Base64.parse(pl.salt), CryptoJS.enc.Base64.parse(pl.iv));
    if (decrypted === "") throw "No data returned";

    // Set default iframe link targets to _top so all links break out of the iframe
    decrypted = decrypted.replace("<head>", "<head><base href=\".\" target=\"_top\">");

    srcDoc.set(contentFrame, decrypted);

    successEl.style.display = "inline";
    passEl.disabled = true;
    submitPass.disabled = true;
    setTimeout(function() {
      dialogWrap.style.display = "none";
    }, 1000);
  } catch (e) {
    invalidPassEl.style.display = "inline";
    passEl.value = "";
  }
}

submitPass.onclick = doSubmit;
passEl.onkeypress = function(e) {
  if (!e) e = window.event;
  var keyCode = e.keyCode || e.which;
  invalidPassEl.style.display = "none";
  if (keyCode == '13'){
    // Enter pressed
    doSubmit();
    return false;
  }
};

function decryptFile(contents, password, salt, iv) {
  var _cp = CryptoJS.lib.CipherParams.create({
    ciphertext: contents
  });
  var key = CryptoJS.PBKDF2(password, salt, { keySize: 256/32, iterations: 100 });
  var decrypted = CryptoJS.AES.decrypt(_cp, key, {iv: iv});

  return decrypted.toString(CryptoJS.enc.Utf8);
}
